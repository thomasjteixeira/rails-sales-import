#!/usr/bin/env bash
# exit on error
set -o errexit

echo "🔨 Starting Render build process..."

# Create storage directory for SQLite
echo "📁 Creating storage directory..."
mkdir -p storage

# Install dependencies
echo "📦 Installing Ruby gems..."
bundle install

# Setup database and seed
echo "🗄️ Setting up database..."
RAILS_ENV=production bundle exec rails db:prepare

echo "🌱 Seeding database with sample data..."
RAILS_ENV=production bundle exec rails db:seed

# Precompile assets
echo "🎨 Precompiling assets..."
bundle exec rails assets:precompile

# Clean up
echo "🧹 Cleaning up..."
bundle exec rails assets:clean

echo "✅ Build completed successfully!"
